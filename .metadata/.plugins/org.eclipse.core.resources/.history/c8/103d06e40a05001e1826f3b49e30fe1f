package Appium;

import java.net.URL;
import java.time.Duration;
import java.io.FileInputStream;
import java.io.File;
import java.io.IOException;
import org.openqa.selenium.interactions.Actions;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import io.appium.java_client.TouchAction;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.remote.DesiredCapabilities;
import io.appium.java_client.android.AndroidDriver;
import io.appium.java_client.remote.MobileCapabilityType;
import io.appium.java_client.touch.WaitOptions;
import io.appium.java_client.touch.offset.PointOption;

public class ALL_CHECK {
	public static void main(String args[]) throws Exception {
//		for (int i = 5; i <= 25; i++) {
		DesiredCapabilities dc = new DesiredCapabilities();
		dc.setCapability(MobileCapabilityType.AUTOMATION_NAME, "Appium"); // automation name
		dc.setCapability(MobileCapabilityType.PLATFORM_NAME, "Android"); // Platform name
		dc.setCapability(MobileCapabilityType.PLATFORM_VERSION, "13.0"); // platfrom os version
		dc.setCapability(MobileCapabilityType.DEVICE_NAME, "Android Emulator");

		dc.setCapability("appPackage", "com.healthismplus.customer.dev");
		dc.setCapability("appActivity", "com.healthismplus.customer.MainActivity");

		// url to connect with appium server.
		URL url = new URL("http://localhost:4723/wd/hub");

		// creating Android Driver for interacting with Android
		AndroidDriver driver = new AndroidDriver(url, dc);
		Actions ac = new Actions(driver);
		TouchAction acb = new TouchAction(driver);

		FileInputStream fis = new FileInputStream("C:\\Users\\HP\\Desktop\\TechVizor\\150.xlsx");
		XSSFWorkbook workbook = new XSSFWorkbook(fis);
		XSSFSheet sheet = workbook.getSheet("Sheet1");
		int rowcount = sheet.getLastRowNum();
		int colcount = sheet.getRow(1).getLastCellNum();

		System.out.println(" rowcount :" + rowcount + " colcount :" + colcount);

		XSSFRow celldata = sheet.getRow(i);
		String id_username = celldata.getCell(5).getStringCellValue();
		String Email = celldata.getCell(4).getStringCellValue();
		String name = celldata.getCell(1).getStringCellValue();

		Thread.sleep(2000);

		WebElement user_id = driver.findElement(By.xpath(
				"/hierarchy/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.view.View/android.view.View/android.view.View/android.view.View/android.widget.EditText"));
		user_id.click();
		user_id.sendKeys(id_username);
		driver.navigate().back(); // For Back
		Thread.sleep(3000);

		WebElement clickcon = driver.findElement(By.xpath("//android.widget.Button[@index='4']"));
		clickcon.click();
		Thread.sleep(2000);

		WebElement OTP = driver.findElement(By.xpath(
				"/hierarchy/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.view.View/android.view.View/android.view.View/android.view.View/android.widget.EditText"));
		OTP.click();
		OTP.sendKeys("1597");
		Thread.sleep(2000);

		WebElement login = driver.findElement(By.xpath("//android.widget.Button[@content-desc=\"Continue\"]"));
		login.click();
		Thread.sleep(4000);

		WebElement loc = driver
				.findElement(By.id("com.android.permissioncontroller:id/permission_allow_foreground_only_button"));
		loc.click();
		Thread.sleep(2000);

		WebElement loccon = driver
				.findElement(By.xpath("	\r\n" + "//android.widget.Button[@content-desc=\"Confirm Location\"]"));
		loccon.click();
		Thread.sleep(2000);
		driver.close();
//		}
	}
}
